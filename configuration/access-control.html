<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Access Control - Authelia</title> <link rel="shortcut icon" href="https://authelia.github.io/authelia/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://authelia.github.io/authelia/assets/css/just-the-docs.css"> <script type="text/javascript" src="https://authelia.github.io/authelia/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://authelia.github.io/authelia/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Access Control | Authelia</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Access Control" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <link rel="canonical" href="https://authelia.github.io/authelia/configuration/access-control.html" /> <meta property="og:url" content="https://authelia.github.io/authelia/configuration/access-control.html" /> <meta property="og:site_name" content="Authelia" /> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://authelia.github.io/authelia/images/authelia-title.png"}},"description":"Authelia is an open source multi-factor single sign-on portal for web applications","headline":"Access Control","@type":"WebPage","url":"https://authelia.github.io/authelia/configuration/access-control.html","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="https://authelia.github.io/authelia" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="https://authelia.github.io/authelia/" class="navigation-list-link">Home</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/home/architecture.html" class="navigation-list-link">Architecture</a></li></ul></li><li class="navigation-list-item"><a href="https://authelia.github.io/authelia/getting-started.html" class="navigation-list-link">Getting Started</a></li><li class="navigation-list-item"><a href="https://authelia.github.io/authelia/features/" class="navigation-list-link">Features</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/features/first-factor.html" class="navigation-list-link">First Factor</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/features/2fa/" class="navigation-list-link">Second Factor</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/features/2fa/one-time-password.html" class="navigation-list-link">One-Time Password</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/features/2fa/security-key.html" class="navigation-list-link">Security Keys</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/features/2fa/push-notifications.html" class="navigation-list-link">Push Notification</a> </li></ul></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/features/single-factor.html" class="navigation-list-link">Single Factor</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/features/password-reset.html" class="navigation-list-link">Password Reset</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/features/access-control.html" class="navigation-list-link">Access Control</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/features/regulation.html" class="navigation-list-link">Regulation</a></li></ul></li><li class="navigation-list-item active"><a href="https://authelia.github.io/authelia/configuration/" class="navigation-list-link">Configuration</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/authentication/" class="navigation-list-link">Authentication backends</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/configuration/authentication/file.html" class="navigation-list-link">File</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/configuration/authentication/ldap.html" class="navigation-list-link">LDAP</a> </li></ul></li><li class="navigation-list-item active"><a href="https://authelia.github.io/authelia/configuration/access-control.html" class="navigation-list-link active">Access Control</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/duo-push-notifications.html" class="navigation-list-link">Duo Push Notifications</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/google-analytics.html" class="navigation-list-link">Google Analytics</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/miscellaneous.html" class="navigation-list-link">Miscellaneous</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/notifier/" class="navigation-list-link">Notifier</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/configuration/notifier/filesystem.html" class="navigation-list-link">Filesystem</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/configuration/notifier/smtp.html" class="navigation-list-link">SMTP</a> </li></ul></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/one-time-password.html" class="navigation-list-link">One-Time Password</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/regulation.html" class="navigation-list-link">Regulation</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/secrets.html" class="navigation-list-link">Secrets</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/session.html" class="navigation-list-link">Session</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/configuration/storage/" class="navigation-list-link">Storage backends</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/configuration/storage/mariadb.html" class="navigation-list-link">MariaDB</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/configuration/storage/postgres.html" class="navigation-list-link">PostgreSQL</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/configuration/storage/sqlite.html" class="navigation-list-link">SQLite</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="https://authelia.github.io/authelia/deployment/" class="navigation-list-link">Deployment</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/deployment/deployment-lite.html" class="navigation-list-link">Deployment - Lite</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/deployment/deployment-ha.html" class="navigation-list-link">Deployment - Highly-Available</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/deployment/deployment-kubernetes.html" class="navigation-list-link">Deployment - Kubernetes</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/deployment/supported-proxies/" class="navigation-list-link">Supported Proxies</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/deployment/supported-proxies/haproxy.html" class="navigation-list-link">HAProxy</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/deployment/supported-proxies/nginx.html" class="navigation-list-link">Nginx</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/deployment/supported-proxies/traefik1.x.html" class="navigation-list-link">Traefik 1.x</a> </li><li class="navigation-list-item "> <a href="https://authelia.github.io/authelia/deployment/supported-proxies/traefik2.x.html" class="navigation-list-link">Traefik 2.x</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="https://authelia.github.io/authelia/security/" class="navigation-list-link">Security</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/security/report.html" class="navigation-list-link">Report Vulnerabilities</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/security/measures.html" class="navigation-list-link">Security Measures</a></li></ul></li><li class="navigation-list-item"><a href="https://authelia.github.io/authelia/contributing/" class="navigation-list-link">Contributing</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/contributing/authelia-scripts.html" class="navigation-list-link">Authelia Scripts</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/contributing/build-and-dev.html" class="navigation-list-link">Build & Dev</a></li><li class="navigation-list-item "><a href="https://authelia.github.io/authelia/contributing/suites.html" class="navigation-list-link">Suites</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Authelia" aria-label="Search Authelia" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://authelia.github.io/authelia/configuration/">Configuration</a></li> <li class="breadcrumb-nav-list-item"><span>Access Control</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 class="no_toc" id="access-control"> <a href="#access-control" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Access Control </h1> <h2 id="access-control-list"> <a href="#access-control-list" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Access Control List </h2> <p>With <strong>Authelia</strong> you can define a list of rules that are going to be evaluated in order when authorization is delegated to Authelia.</p> <p>The first matching rule of the list defines the policy applied to the resource and, if no rule matches the resource, a customizable default policy is applied.</p> <h2 id="access-control-rule"> <a href="#access-control-rule" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Access Control Rule </h2> <p>A rule defines two things:</p> <ul> <li>the matching criterion of the request presented to the reverse proxy</li> <li>the policy applied when all criterion match.</li> </ul> <p>The criterion are:</p> <ul> <li>domain: domain targeted by the request.</li> <li>resources: list of patterns that the path should match (one is sufficient).</li> <li>subject: the user or group of users to define the policy for.</li> <li>networks: the network range from where should comes the request.</li> </ul> <p>A rule is matched when all criterion of the rule match</p> <h2 id="policies"> <a href="#policies" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Policies </h2> <p>A policy represents the level of authentication the user needs to pass before being authorized to request the resource.</p> <p>There exist 4 policies:</p> <ul> <li>bypass: the resource is public as the user does not need any authentication to get access to it.</li> <li>one_factor: the user needs to pass at least the first factor to get access to the resource.</li> <li>two_factor: the user needs to pass two factors to get access to the resource.</li> <li>deny: the user does not have access to the resource.</li> </ul> <h2 id="domains"> <a href="#domains" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Domains </h2> <p>The domains defined in rules must obviously be either a subdomain of the domain protected by Authelia or the protected domain itself. In order to match multiple subdomains, the wildcard matcher character <code class="language-plaintext highlighter-rouge">*.</code> can be used as prefix of the domain. For instance, to define a rule for all subdomains of <em>example.com</em>, one would use <code class="language-plaintext highlighter-rouge">*.example.com</code> in the rule.</p> <h2 id="resources"> <a href="#resources" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Resources </h2> <p>A rule can define multiple regular expressions for matching the path of the resource. If any one of them matches, the resource criteria of the rule matches.</p> <h2 id="subjects"> <a href="#subjects" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Subjects </h2> <p>A subject is a representation of a user or a group of user for who the rule should apply.</p> <p>For a user with unique identifier <code class="language-plaintext highlighter-rouge">john</code>, the subject should be <code class="language-plaintext highlighter-rouge">user:john</code> and for a group uniquely identified by <code class="language-plaintext highlighter-rouge">developers</code>, the subject should be <code class="language-plaintext highlighter-rouge">group:developers</code>. Unlike resources there can be only one subject per rule. However, if multiple users or group must be matched by a rule, one can just duplicate the rule as many times as there are subjects.</p> <p><em>Note: Any PR to make it a list instead of a single item is welcome.</em></p> <h2 id="networks"> <a href="#networks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Networks </h2> <p>A list of network ranges can be specified in a rule in order to apply different policies when requests come from different networks.</p> <p>The main use case is when, let say a resource should be exposed both on the Internet and from an authenticated VPN for instance. Passing a second factor a first time to get access to the VPN and a second time to get access to the application can sometimes be cumbersome if the endpoint is not that much sensitive.</p> <p>Even if Authelia provides that flexbility, you might prefer higher level of security and avoid this option entirely. You and only you can define your security policy and it’s up to you to configure Authelia accordingly.</p> <h2 id="complete-example"> <a href="#complete-example" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Complete example </h2> <p>Here is a complete example of complex access control list that can be defined in Authelia.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>access_control:
    default_policy: deny

    rules:
    - domain: public.example.com
      policy: bypass

    - domain: secure.example.com
      policy: one_factor
      networks:
      - 192.168.1.0/24
  
    - domain: secure.example.com
      policy: two_factor

    - domain: singlefactor.example.com
      policy: one_factor

    - domain: "mx2.mail.example.com"
      subject: "group:admins"
      policy: deny
    
    - domain: "*.example.com"
      subject: "group:admins"
      policy: two_factor

    - domain: dev.example.com
      resources:
      - "^/groups/dev/.*$"
      subject: "group:dev"
      policy: two_factor

    - domain: dev.example.com
      resources:
      - "^/users/john/.*$"
      subject: "user:john"
      policy: two_factor
</code></pre></div></div> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 Authelia. Distributed by an <a href="https://github.com/authelia/authelia/blob/master/LICENSE">Apache 2.0 license.</a></p> </footer> </div> </div> </div> </div> </body> </html>
